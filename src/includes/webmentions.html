{% assign wm_url = page.url | absolute_url %}
{% assign mentions = webmentions | getMentionsForUrl: wm_url %}

<section id="webmentions">
    <p class="wm-title">Webmentions</p>
    <div class="wm-summary">
        <p class="wm-likes" title="likes">
            <span aria-label="Likes:">‚ù§Ô∏è</span> {{ mentions.likes | size }}
        </p>
        <p class="wm-replies" title="replies">
            <span aria-label="Replies:">üí¨</span> {{ mentions.replies | size }}
        </p>
        <p class="wm-info" title="What are webmentions?">
            <img src="/assets/icons/icon-info.svg" alt="" width="24" height="24" class="icon">
            <a
                href="https://indieweb.org/Webmention"
                target="_blank"
                rel="noopener noreferrer"
            >What's this?</a>
        </p>
    </div>
    <ul class="wm-mentions">
        {% for mention in mentions.replies %}
        <li class="u-comment h-cite wm-mention">
            <a class="u-url h-card wm-mentioner" href="{{mention.url}}" target="_blank" rel="noopener noreferrer">
                <img class="u-photo wm-mentioner__img" src="{{mention.author.photo}}" alt="Picture of {{mention.author.name}}">
                <span class="p-name wm-mentioner__name">{{mention.author.name}}</span>
            </a>
            <time class="dt-published wm-mention__time" datetime="{{mention['wm-received'] | date: '%Y-%m-%dT%H:%M:%S%z'"}}">{{mention['wm-received'] | date: "%B %d, %Y - %I:%M%P"}}</time>
            <div class="p-content wm-mention__content">{{mention.content.html | truncate: 160}}</div>
        </li>
        {% endfor %}
    </ul>
</section>
